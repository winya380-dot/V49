<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drink Stock App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 75%;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      font-size: 120%;
      margin: 10px 0;
    }
    section {
      display: none;
      margin-top: 15px;
    }
    section.active {
      display: block;
    }
    table {
      width: 90%;
      border-collapse: collapse;
      margin: 10px auto;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 2px 4px;
      text-align: center;
      font-size: 90%;
      height: 25px;
    }
    th:nth-child(2), td:nth-child(2) {
      width: 30%;
    }
    td[data-col="pos"], td[data-col="fridge"], td[data-col="pending"], td.status {
      width: 15%;
    }
    td[contenteditable="true"] {
      background-color: #f9f9f9;
      outline: none;
    }
    .status {
      font-weight: bold;
      font-size: 85%;
    }
    input[type="text"] {
      padding: 5px;
      font-size: 90%;
      margin: 5px;
      width: 50%;
    }
    button.action-btn {
      padding: 6px 12px;
      font-size: 90%;
      margin: 8px 5px;
      cursor: pointer;
    }
    .main-menu button {
      display: block;
      width: 80%;
      margin: 10px auto;
      font-size: 100%;
      padding: 12px;
    }
    .delete-btn {
      background-color: #ff4d4d;
      color: #fff;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 3px;
    }
    .delete-btn:hover {
      background-color: #cc0000;
    }
    .save-btn {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 3px;
    }
    .save-btn:hover {
      background-color: #45a049;
    }
    .button-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 90%;
      margin: 10px auto;
    }
  </style>
</head>
<body>
  <h1>Drink Stock App</h1>

  <!-- Main Menu -->
  <section id="menu" class="active main-menu">
    <h2>Main Menu</h2>
    <button onclick="showSection('stock')">Stock Checker</button>
    <button onclick="showSection('add')">Add Drink</button>
    <button onclick="showSection('edit')">Edit Drinks</button>
  </section>

  <!-- Stock Checker -->
  <section id="stock">
    <h2>Stock Checker</h2>
    <div class="button-bar">
      <div>
        <button onclick="showSection('menu')">⬅ Back</button>
      </div>
      <div>
        <button type="submit" form="stock_form" class="action-btn">Check Stock</button>
        <button type="button" id="clear_btn" class="action-btn">Clear</button>
      </div>
    </div>
    <form id="stock_form">
      <table id="stock_table">
        <thead>
          <tr>
            <th>List</th>
            <th>Drink</th>
            <th>POS</th>
            <th>Fridge</th>
            <th>Pending Bill</th>
            <th>Summary</th>
          </tr>
        </thead>
        <tbody id="table_body"></tbody>
      </table>
    </form>
  </section>

  <!-- Add Drink -->
  <section id="add">
    <h2>Add New Drink</h2>
    <button onclick="showSection('menu')">⬅ Back</button>
    <input type="text" id="new_drink" placeholder="Enter drink name" />
    <button class="action-btn" onclick="addDrink()">Add</button>
    <p id="add_message" style="color: green; font-weight: bold;"></p>
  </section>

  <!-- Edit Drinks -->
  <section id="edit">
    <h2>Edit Drinks</h2>
    <button onclick="showSection('menu')">⬅ Back</button>
    <table>
      <thead>
        <tr><th>List</th><th>Drink Name</th><th>Action</th></tr>
      </thead>
      <tbody id="edit_table"></tbody>
    </table>
  </section>

  <script>
    let drinks = JSON.parse(localStorage.getItem("drinks")) || [
      "Big beer lao (bottle)", "Small beer lao (bottle)", "Big beer lao (can)", "Small beer lao (can)",
      "Beer lao IPA", "Beer lao white", "Beer lao gold", "Beer lao green", "Beer lao dark",
      "Beer lao LPB", "Beer carsberge 330ml", "Sommersby", "Pepsi", "Miranda", "Tonic water",
      "Soda water", "Small tiger head water", "Potato chips", "Red wine (glass)", "White wine (glass)"
    ];

    const tbody = document.getElementById("table_body");
    const editTable = document.getElementById("edit_table");

    function showSection(id) {
      document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      if (id === 'stock') renderStockTable();
      if (id === 'edit') renderEditTable();
    }

    function renderStockTable() {
      tbody.innerHTML = "";
      drinks.forEach((drink, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${drink}</td>
          <td contenteditable="true" data-col="pos"></td>
          <td contenteditable="true" data-col="fridge"></td>
          <td contenteditable="true" data-col="pending"></td>
          <td class="status" id="result_${index}">-</td>
        `;
        tbody.appendChild(row);
      });
    }

    function renderEditTable() {
      editTable.innerHTML = "";
      drinks.forEach((drink, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td contenteditable="true" id="edit_${index}">${drink}</td>
          <td>
            <button class="save-btn" onclick="saveEdit(${index})">Save</button>
            <button class="delete-btn" onclick="deleteDrink(${index})">Delete</button>
          </td>
        `;
        editTable.appendChild(row);
      });
    }

    document.getElementById("stock_form").addEventListener("submit", function(e) {
      e.preventDefault();
      const rows = tbody.querySelectorAll("tr");
      rows.forEach((row, index) => {
        const pos = parseInt(row.querySelector('td[data-col="pos"]').textContent.trim() || 0);
        const fridge = parseInt(row.querySelector('td[data-col="fridge"]').textContent.trim() || 0);
        const pending = parseInt(row.querySelector('td[data-col="pending"]').textContent.trim() || 0);

        if (!pos && !fridge && !pending) {
          document.getElementById(`result_${index}`).textContent = "-";
          return;
        }

        const actual = fridge + pending;
        const diff = pos - actual;

        let message = "";
        if (diff === 0) {
          message = "✔️ Complete";
        } else if (diff > 0) {
          message = `🔴 Missing ${diff}`;
        } else {
          message = `🟢 Extra ${Math.abs(diff)}`;
        }
        document.getElementById(`result_${index}`).textContent = message;
      });
    });

    document.getElementById("clear_btn").addEventListener("click", () => {
      document.querySelectorAll('td[contenteditable="true"]').forEach(cell => cell.textContent = "");
      document.querySelectorAll(".status").forEach(cell => cell.textContent = "-");
    });

    function addDrink() {
      const newDrink = document.getElementById("new_drink").value.trim();
      if (newDrink) {
        drinks.push(newDrink);
        saveToLocal();
        renderEditTable();
        document.getElementById("add_message").textContent = `Added: ${newDrink}`;
        document.getElementById("new_drink").value = "";
      } else {
        document.getElementById("add_message").textContent = "Please enter a drink name.";
      }
    }

    function saveEdit(index) {
      const newName = document.getElementById(`edit_${index}`).textContent.trim();
      if (newName) {
        drinks[index] = newName;
        saveToLocal();
        renderEditTable();
        alert(`Updated to: ${newName}`);
      }
    }

    function deleteDrink(index) {
      if (confirm("Are you sure you want to delete this drink?")) {
        drinks.splice(index, 1);
        saveToLocal();
        renderEditTable();
      }
    }

    function saveToLocal() {
      localStorage.setItem("drinks", JSON.stringify(drinks));
    }

    showSection('menu');
  </script>
</body>
  </html>
